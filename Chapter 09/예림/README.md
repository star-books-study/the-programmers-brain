# Chapter 09. 나쁜 코드와 인지 부하를 방지하는 두 가지 프레임워크

## 9.1 코드 스멜이 인지 부하를 초리하는 이유
- 코드 스멜 : 작동은 하지만 개선의 여지가 있는 코드
  - 매우 긴 메서드나 지나치게 복잡한 스위치 문 등

### 코드 스멜이 인지 과정에 악영향을 미치는 방식
- 많은 코드 스멜은 두뇌의 인지 기능과 관련이 있다.

#### 긴 매개변수 목록, 복잡한 스위치 문 : 작업 기억 공간의 용량 초과
- 6개를 넘는 매개변수 리스트는 사람들이 기억하기에 무리가 있다.
- 이런 경우 코드를 읽는 동안 모든 매개변수를 작업 기억 공간에 저장할 수 없다.
  ➡️ 메서드에 매개변수가 많을수록 이해하기는 더 어려울 것이다.
- 예시
  ```java
  public void line(int xOrigin, int yOrigin, int xDestination, in yDestination) {}
  ```
  - 우리 두뇌는 이것을 4개의 청크가 아닌 2개의 청크로 취급
- 따라서 매개변수 개수 제한은 상황에 따라 달라지며 코드의 요소에 대한 사전 지식에 따라 달라진다.

#### 신의 클래스, 긴 메서드 : 효율적인 청킹이 불가능
- 코드로 작업할 때 우리는 끊임없이 추상화를 생성한다.
- 함수 및 클래스 이름은 코드를 청킹할 수 있도록 도와준다.
- 신의 클래스와 긴 메서드와 같이 큰 코드 블록과 관련된 코드스멜은 좋지 않다.

#### 코드 클론 : 청킹이 잘못됨
- 코드 클론 또는 중복 코드 스멜은 별 차이 없는 코드가 코드 베이스에 추가될 때 발생
```java
int foo(int j) {
  if(j < 0)
    return j;
  else
    return ++j;
}
```
```java
int goo(int j) {
  if(j < 0)
    return j;
  else
    return j+2;
}
```
- goo()와 같이 foo()와 매우 유사한 함수 호출을 보게 되면 작업 기억 공간은 LTM에서 foo()에 대한 정보를 수집할 것이다.
- 그리고 goo()를 구현한 코드를 대충 훑어보고, foo()에 대한 사전 지식이 애초의 생각을 강화하면, '아, 이거 foo() 맞네'라고 생각할 것이다.
- 따라서 goo()가 다른 값을 반환하더라도 goo()는 foo()와 같다는 오개념이 생겨날 수 있다.


## 9.2 나쁜 이름이 인지 부하에 미치는 영향
- 코드 스멜은 **구조적 안티패턴** 문제가 있는 코드다. 이것은 코드가 잘 작성되었으나 파악하기 어려운 구조로 만들어졌다는 것을 의미한다.
- 그러나 코드에는 '개념적' 안티패턴도 있을 수 있다.
  - 코드가 짧은 메서드와 깔끔한 클래스로 올바르게 구성되어 있지만 혼동되는 이름을 갖는 경우
- 이러한 코드 문제는 두 번째 프레임워크인 **언어적 안티패턴**으로 설명할 수 있다.

### 언어적 안티패턴
- 언어적 안티패턴 : 코드의 언어적 요소와 그 역할 사이의 불일치
  - 언어적 요소 : 메서드 입출력 정의, 설명 문서, 속성 이름, 데이터 타입, 주석문 등을 포함하는 코드의 자연어 부분
- 안티 패턴은 언어적 요소가 수행하는 역할과 일치하지 않을 때 발생

> 코드 베이스에 언어적 안티패턴 문제가 있는지 궁금하다면 LAPD라는 이클립스 체크스타일 플러그인을 사용할 수 있다.
- 언어적 안티패턴이 인지 부하에 미치는 영향을 자세히 알아보기 전에 먼저 인지 부하가 어떻게 측정될 수 있는지 살펴보자.


### 인지 부하 측정
- 과학자들은 인지 부하를 측정할 때 **파스 척도**(Paas scale)를 자주 사용한다.
- 파스 척도에서 참가자들은 인지 부하에 대해 스스로 1점에서 9점 사이에서 점수를 매긴다.
![image](https://github.com/user-attachments/assets/3b250d52-7d51-4d0b-b146-ea05b0948d3c)


#### 눈 기반 측정
- 참가자의 인식에 기초한 측정 지표 외에도, 최근의 연구에서는 생물학적 측정 지표의 사용이 늘어나고 있다.
- 특정 작업에 대한 신체의 반응을 측정함으로써 그 순간 그 사람이 무엇을 하고 있든 그 일에서 발생하는 인지 부하를 추정할 수 있다.
- 생체 측정의 예는 `시선 추적`이다. 시선 추적 장치를 이용하면 사람들이 얼마나 집중하고 있는지 알 수 있다.
  - 깜박임 비율 측정 :  **눈을 얼마나 자주 깜박이는지 검사**
    - 작업이 어려울 수록 깜빡임이 줄어드는 것으로 보고됐다.
    - 두뇌가 어려운 일을 최대한으로 파악하려고 하고 이에 따라 가능한 한 많은 시각적 자극을 받기 위해 노력한다는 것이다.
  - 동공 크기
    - 작업이 어려울 수록 동공 크기도 크게 측정되고 인지 부하도 더 커지는 것으로 나타났다.
    - 동공이 크면 눈이 더 많은 정보를 흡수할 수 있기 때문
    - 어려운 작업을 할 때 뇌는 더 많은 정보를 찾는다.
   
#### 피부 기반 측정
- 피부 온도, 땀 흘리는 정도 등

> 인지 부하를 측정하기 위한 이러한 생체 측정 방법은 파스 척도와 상관관계가 있다는 연구 결과가 많다. 따라서 피트니스 트래커를 사용할 수도 있지만 단순히 파스 척도를 이용하는 것으로도 충분하다.

#### 뇌 기반 측정
- 뇌가 어떤 활동을 하는지 측정하기 위해 fMRI 스캐너를 사용하는 것에 대해 5장에서 살펴봤다.
- fMRI 기계는 측정은 정확하지만 큰 제약이 있다.
  - 가만히 누워 있어야 해서 코드를 작성할 수 없다.
- 이러한 한계로 인해 다른 두뇌 측정 방법도 사용된다.

#### 뇌전도
- EEG 장치는 뇌 활동이 일으키는 전압의 변화를 측정함으로써 발생하는 뉴런의 활동 변화를 측정한다.
- 또 다른 방법으로는 기능적 근적외선 분광기(fNIRS)를 사용하는 것이다.
- 적외선 광 센서를 사용해 감지되는 빛의 양을 판별함으로써 해당 영역의 산소화 및 탄산소화된 헤모글로빈의 양을 계산
- 혈액에 산소 공급이 많아지면 인지 부하가 증가한 것

#### 기능적 fNIRS와 프로그래밍
- 나카가와 다카오는 웨어러블 fNIRS 기기를 사용해 프로그램을 이해하는 동안의 뇌 활동 측정
- 10명 중 8명의 경우, 산소가 들어간 혈류량이 기존 프로그램을 읽을 때보다 복잡한 프로그램을 읽을 떄 더 큰 것으로 나타났다.
  ➡️ fNIRS 기기를 사용해 뇌혈류를 측정하면 프로그래밍 중 발생하는 인지 부하 정량화 가능

### 언어적 안티 패턴 및 인지 부하
- 연구자들은 fNIRS를 이용해 언어적 안티패턴이 인지 부하에 미치는 영향을 측정할 수 있었다.
- 연구진들은 의도적으로 코드에 버그를 추가하고 참가자들에게 버그를 찾을 것을 요청했다.
- 코드에 좀 더 많은 수정을 가해 코드를 다음 네 가지로 변형했다.
  1. 언어적 안티패턴을 갖도록 변경한 코드
  2. 구조적 불일치를 갖도록 변경한 코드
  3. 두 가지 사항을 다 갖도록 변경한 코드
  4. 원래의 코드
- 이를 통해 연구진들은 잘못된 구조와 언어적 안티 패턴의 효과를 비교할 수 있었다.
- 언어적 안티패턴이 있는 소스 코드를 읽을 때 평균 산소화 혈류량이 유의미하게 증가하는 것으로 나타났다. (즉, 언어적 안티패턴이 초래하는 인지 부하가 더 높음)

### 언어적 안티 패턴이 혼란을 일으키는 이유
- 언어적 안티 패턴을 많이 가지고 있는 코드는 인지 부하를 더 많이 유발한다.
- 언어적 안티 패턴이 포함된 코드를 읽을 때는 두 가지 인지적 문제가 발생할 수 있다.
- 익숙하지 않은 내용을 읽을 때, LTM은 관련 사실과 경험을 검색한다. 이 때 충돌하는 이름을 읽게 되면 잘못된 정보가 주어질 수 있다.
  - ex) `retrieveElements()`를 보면 리스트를 반환하는 함수라고 생각 (단일 원소에는 해당되지 않는 사항)
- 중복 코드처럼 '잘못된 청킹'이 발생할 수 있다.
  - ex) `isValid` 같은 변수 이름을 보면 불리언 변수라고 단순하게 가정할 수 있다. 이 변수에 리스트가 반환되는지 확인하기 위해 코드를 더 들여다볼 필요 가 없다는 의미
 
## 요약
- 긴 메서드 등 코드 스멜은 코드의 구조적 문제를 의미한다. 코드 스멜이 인지 부하를 높이는 데는 여러 인지적 이유가 있다. 예를 들어 중복 코드는 제대로 청킹하기 어렵게 만들고, 긴 매개변수 목록은 작업 기억 공간을 많이 차지 한다.
- 생체 인식 센서 등 인지 부하 측정 방법에는 다양한 방법이 있다. 일반적으로는 파스 척도가 신뢰할 수 있는 도구
- 언어적 안티패턴이란 코드가 실제 수행하는 작업과 맞지 않는 이름을 의미하며, 높은 인지 부하를 초래한다. 이는 우리가 사고할 때 LTM이 돕는 과정에서 잘못된 사실을 발견하기 때문에 일어날 수 있다. 이는 잘못된 청킹으로 이어질 수 있다.
