# Chapter 04. 복잡한 코드를 읽는 방법

## 4.1 복잡한 코드를 이해하는 것이 왜 어려울까?
- 코드를 보면서 변수에 저장된 값을 적어놓게 되는 건 **우리 두뇌가 처리할 용량이 부족**하다는 것을 의미한다.
- 즉, 작업 기억 공간이 '과부하' 상태가 된 것이다.

### 작업 기억 공간과 STM의 차이
- STM의 역할은 정보를 기억하는 것인 반면, 작업 기억 공간의 역할은 정보를 처리하는 것이다.
- STM과 같이 작업 기억 공간도 한 번에 2개에서 6개까지만 기억할 수 있다. 작업 기억 공간의 맥락에서 이 용량을 인지 부하라고 부른다.
- 너무 많은 요소가 있어 청크로 나뉘지 않는 문제를 풀려고 할 때 작업 기억 공간은 '과부하' 상태가 된다.

### 프로그래밍과 관련한 인지 부하의 종류
- 인지 부하의 종류 3가지
  - 내재적 부하 : 문제 자체가 얼마나 복잡한지
  - 외재적 부하 : 외부적 요인에 의해 문제에 추가된 것
  - 본유적 부하 : 생각을 LTM에 저장하는 과정에서 일어나는 인지 부하

## 4.2 인지 부하를 줄이기 위한 방법

### 리팩토링
- 코드가 전체적으로 유지 보수하기 좋게 수정됐다고 해서 가독성까지 반드시 좋아지는 것은 아니다.
  - 예를 들어 메서드 호출이 많은 코드를 생각해보자. 메서드가 같은 파일 혹은 여러 파일에 걸쳐서 존재하는 메서드라면 이 코드는 유지 보수하기에는 좋지만 여러 군데에서 메서드 구현을 찾아봐야 하기 때문에 작업 기억 공간에는 어려움을 줄 수 있다.
- **따라서 유지 보수하기 좋은 코드를 작성하기보다는 장기적으로 가독성이 높은 코드를 작성하도록 리팩터링하는 것이 좋을 수도 있다.**
- 이런 방식의 리팩터링을 **인지적 리팩터링**이라고 한다.
  - 현 시점에서 개발자가 읽기 쉬운 코드로 변경하는 것
- 또 다른 방법으로는 코드 내에서 메서드의 순서를 변경할 수도 있다.
  - 최초로 호출되는 위치로부터 가까이 정의되어 있다면 가독성이 좋아진다.
- **사람마다 지식에 따라 코드의 이해도가 달라지고 래픽터링하는 내용도 달라지기 때문에 인지적 리팩터링은 개발자 자신만을 위한 리팩터링이다.
- **많은 경우 인지적 리팩터링은 일시적이고 자신이 코드를 이해하는 게 목적이므로 일단 이해하고 나면 코드를 원래 상태로 되돌릴 수도 있다.**

### 생소한 언어 구성 요소를 다른 것으로 대치하기
- 코드에 있는 프로그래밍 개념이 익숙하지 않다면 지식의 부족 문제를 겪을 것이다. 
  - ex. 파이썬의 리스트 컴프리헨션, 람다 함수
- 읽거나 작성하는 코드가 간단하고 명확하면 람다나 리스트 컴프피켄션이 문제되지 않지만, 복잡한 코드의 경우에는 작업 기억 공간에 과부하가 발생한다.
- 익숙하지 않은 언어 구성 요소는 작업 기억 공간과 외재적 인지 부하를 늘리기 때문에 복잡한 코드를 읽을 때는 이들로 인한 부하가 늘어나지 않게 하는 것이 좋다.
- 하지만 자신의 코드베이스에 따라 일단 코드를 이해하고 나면 가독성을 위해 수정한 코드를 되돌릴 수도 있다.
- 새로운 일에 합류했는데 자기 자신만 리스트 컴프리헨션이 익숙하지 않다면 코드 분석을 위해 리스트 컴프리헨션을 다른 형태로 변경한 후 코드를 이해하고 나면 수정한 코드를 원래 상태로 되돌리면 된다.

### 플래시 카드에 코드 동의어 추가
- 리스트 컴프리헨션이 외워지지 않거나 개념이 이해가 안 된다면 이에 대한 플래시 카드를 추가할 수 있다.
- 이러한 프로그래밍 언어의 고급 개념에 대해서는, 프롬프트 대신 플래시 카드 앞면까지 앙면에 모두 코드를 적으면 더 나은 효과를 얻을 수 있다.
- 즉 앞면에는 삼항 연산자나 람다 같은 고급 개념을 사용한 코드를 적고 뒷면에는 그에 해당하는 전통 방식의 코드를 적는 것이다.
## 4.3 작업 기억 공간에 부하가 오면 사용할 수 있는 기억 보조 수단
- 리팩터링을 해도 코드의 구조가 복잡하다면 여전히 작업 기억 공간에 과부하를 줄 수 있다.
- 복잡한 구조의 코드는 두 가지 방식으로 작업 기억 공간에 과부하를 유발한다.

1. 정확히 코드의 어디를 파악해야하는지 모를 때 필요 이상으로 많은 코드를 읽게 되고 작업 기억 공간의 부하로 이어짐.
2. 코드가 서로 밀접하게 연결되어 있는 경우 두 가지 작업을 동시에 수행

- 작업 기억 공간이 한계에 다다르면 코드를 집중해서 읽을 때 도움이 될 만한 보조 수단을 사용하면 좋다.

### 의존 그래프 생성
- 코드를 프린트하거나 코드를 PDF 파일로 변환한 후 태블릿으로 열어서 디지털로 주석을 달면 좋다.

1. 모든 변수를 원으로 표시한다.
2. 비슷한 변수를 연결한다.
3. 모든 메서드나 함수 호출을 원으로 표시한다.
4. 메서드나 함수 호출을 정의와 연결한다.
5. 클래스의 모든 인스턴스를 원으로 표시한다.
6. 클래스와 그 클래스의 인스턴스를 연결한다.

### 상태표 사용
- 계산이 많은 코드를 파악할 때 도움이 됨
- 코드의 구조보다는 변수의 **값**에 집중
- 테이블의 열은 변수를 나타내고 행은 해당 변수가 각 단계에서 갖는 값을 나타냄.
1. 모든 변수를 나열한다.
2. 테이블을 만들고 각 열에 하나의 변수를 기입한다.
3. 코드의 실행 단계마다 행을 만든다.
4. 코드를 각 단계별로 실행하고 그 단계에서 변수들의 값을 해당하는 열과 행에 적는다.