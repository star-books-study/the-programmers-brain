# Chapter 12. 대규모 시스템의 설계와 개선

- 이 장에서는 인지적 관점에서 코드베이스를 조사하는 기술인 CDN에 대해 논할 것이다.
- 기술적 관점보다는 인지적 관점에서 코드베이스를 검사하면 사람들이 어떻게 코드와 상호작용하는지 더 잘 알 수 있다.

## 12.1 코드베이스의 특성 조사
- 여러가지 라이브러리, 프레임워크, 모듈, 프로그래밍 언어에 대해 논의할 때 기술적 영역에 대해서 뿐만 아니라 **두뇌와 관련해서 무엇을 하는지**에 대해서도 논의할 수 있다.

### 인지적 차원
- 11장에서 살펴본 CDN은 기존 대형 코드베이스의 사용성을 평가하는 데도 사용할 수 있다.
- 이 책에서는 좀 더 일반화해서 프로그래밍 언어가 아닌 코드베이스에 대해서도 CDN을 사용하려고 한다. 이 일반화된 버전을 인지차원<sub>dimensions of code bases, CDCB</sub>이라고 부르고, 이것을 통해 코드베이스를 검토하고, 코드베이스를 어떻게 이해하고 애선할 수 있을지 살펴볼 것이다.
  
#### 오류 경향성<sub>error proneness</sub> 
- 프로그래밍 언어에서의 오류 경향성
  - 자바스크립트 등의 동적 유형 언어에서는 변수가 생성될 때 데이터 타입이 정해지지 않아 변수 타입에 대해 혼동할 수 있다.
- 코드베이스에서의 오류 경향성
  - 일관성 없는 규칙, 문서 부족, 모호한 이름 등

#### 일관성<sub>consistency</sub>
- 비슷한 것들은 서로 얼마나 유사한가? 이름은 항상 동일한 방식으로 만들어지는가?
- 예를 들어 `print()` 또는 `print_customer()` 같은 함수를 호출하는 라인만 봐서는 함수를 작성한 사람이 프로그래밍 언어의 창시자인지 아니면 코드 작성자인지 알 수 없다.
- 이름과 규약을 일관성 없이 사용하는 프레임워크나 언어는 인지 부하를 더 많이 가져올 수 있다.

#### 분산성<sub>diffuseness</sub>
- 프로그래밍 구성 요소가 얼마나 공간을 차지하는지 나타낸다.
- 일부 프로그래밍 언어는 동일한 기능에 대해 다른 프로그래밍 언어보다 더 많은 공간을 차지 한다.
- ex. 같은 기능을 하는 두 개의 파이썬 코드
  
  ```python
  california_branches = []
  for branch in branches:
    if branch.zipcode[0] == '9'
        california_branches.append(branch)
   ```
   ```python
   california_branches = [b for b in branches if b.zipcode[0] == '9']
   ```

#### 숨겨진 의존성<sub>hidden dependency</sub>
- 의존 항목<sub>dependency</sub>이 사용자에게 어느 정도로 가시적으로 나타나는지를 ㅗㅂ여준다.
- 숨겨진 의존성이 높은 시스템 예시
  - HTML 페이지에 자바스크립트로 제어되는 버튼이 있고 자바스크립트는 다른 파일에 저장됨.
- 코드 작성자는 보다 광범위한 문서로 숨겨진 의존성을 보완할 수 있다.

#### 잠정성<sub>provisionality</sub>
- 도구를 사용하는 동안 생각하는 것이 얼마나 쉬운지에 대한 것
- 코드베이스나 프로그래밍 언어가 매우 엄격하다면 코드를 사용해 생각을 표현하는 것은 어려울 수 있다. 이런 경우는 잠정성이 낮다고 말한다.
- 잠정성은 학습 능력의 필수적인 요소

#### 점도<sub>vicosity</sub>
- 특정 시스템을 변경하는 것이 얼마나 어려운가에 대한 차원
  - 잠정성과 관련이 있다.
- 일반적으로 동적 타입 언어로 작성된 코드를 변경하는 것이 조금 더 쉽다.
- 시스템이 변경하기 쉬운지는 프로그래밍 언어나 코드 베이스 자체에 달려 있을 뿐만 아니라 코드 베이스를 둘러싼 요인(테스트 실행 시간 등)도 영향을 미친다.

#### 점진적 평가<sub>progressive evaluation</sub>
- 주어진 시스템에서 부분적인 작업을 확인하거나 실행하는 것이 얼마나 쉬운지
  - 잠정성과 관련이 있다.
- 일부 프로그래밍 시스템은 코드의 실행 도중 코드를 변경한 후 실행을 중지하지 않고 계속 코딩할 수 있다. (ex. 스몰토크, 스크래치)
- 코드베이스 또는 라이브러리를 설게할 때 코드의 일부분만 실행하고 이에 대한 통찰력을 얻을 수 있도록 할 수도 있다.

#### 역할 표현력<sub>role expressiveness</sub>
- 프로그램에서 여러 가지 다른 부분의 역할을 얼마나 쉽게 알 수 있는지를 나타낸다.
- 역할 표현력의 간단한 예는 `file.open()`처럼 거의 모든 프로그래밍 언어에서 매개변수가 없는 함수를 호출할 때 여전히 끝에 두 개의 괄호를 가지고 있다는 점이다. ➡️ `open()`이 함수임을 알 수 있다.

#### 매핑 근접성<sub>closeness of mapping</sub>
- 프로그래밍 언어 또는 코드가 문제 해결 영역에 얼마나 가까운지
- 예를 들어 `executeQuery()` 메서드는 `findCustomrs()` 함수보다 비즈니스 영역과의 매핑 근접성이 낮다.

#### 힘든 정신 활동<sub>hard mental operation</sub>
- C++에서 여러 상황에서 포인터를 사용해야 하는 것, 하스켈에서 모든 함수와 매개변수의 타입을 고려해야 하는 것 등이 힘든 정신 활동에 해당
- 힘든 정신 활동이 모두 나쁜 것은 아님
  - 오류 수 ⬇️, 성능 ⬆️ 등
- 그러나 자신이 설계한 시스템에서 사용자가 이러한 힘든 정신 활동을 수행하는 것이 필요하다면 매우 신중하게 고려해야 함

#### 보조 표기법<sub>secondary notation</sub>
- 프로그래머가 공식 규격에는 없는 의미를 코드에 추가할 가능성을 나타냄.
- ex. 소스코드에 주석문을 추가, 파이썬의 명명된<sub>named</sub> 매개변수

#### 추상화<sub>abstraction</sub>
- 시스템의 사용자가 기본적으로 제공되는 추상화만큼 강력한 추상화를 만들 수 있는지 여부
- 예를 들어 라이브러리 사용자가 추가 기능을 위해 하위 클래스를 만들 수 있도록 허용하는 것은 API 호출만 허용하는 라이브러리보다 추상화가 더 강력하다

#### 가시성<sub>visibility</sub>
- 시스템의 다른 부분을 얼마나 쉽게 볼 수 있는지

## 코드베이스 개선을 위해 CDCB 사용
- 인지적 차원 목록은 코드베이스를 위한 일종의 체크리스트로 사용될 수 있다.
- 코드베이스의 인지적 차원을 정기적으로 분석하는 것이 이상적이다.
  
### 설계 기동 및 트레이드오프
- 설계 기동<sub>design maneuver</sub> : 코드베이스에서 특정 차원을 개선하기 위해 코드베이스를 변경하는 것
- 설계 기동으로 인해 다른 차원이 변경되는 경우가 많다. 차원이 어떤 방식으로 정확하게 상호작용하는지는 코드베이스에 따라 크게 달라질 수 있지만, 다음과 같이 차원이 서로 충돌할 때가 있다.

  - 오류 경향성 vs 점도
  - 잠정성 및 점진적 평가 vs 오류 경향성
  - 역할 표현력 vs 분산성

## 12.2 차원 및 활동

### 차원이 활동에 미치는 영향
- 다섯 가지 프로그래밍 활동, 즉 검색, 이해, 전사, 증가, 탐구는 차원과 상호작용 한다.

#### 검색
- 숨겨진 종속성 : 어느 부분을 읽어야 할지 알기 어려워 검색 활동에 악영향을 미칠 수 있다.
- 분산성 : 코드를 더 길게 만들고, 검색할 코드가 더 많기 때문에 검색에 부정적인 영향을 준다.
- 보조 표기법 : 검색에 도움이 된다. 주석 및 변수 이름은 정보를 찾을 수 있는 위치를 나타내기 때문.


#### 이해
- 가시성 : 중요
- 역할 표현력 : 이해에 도움

#### 전사
- 일관성 : 전사할 때 일관성 같은 일부 차원이 나빠질 수 있다. 새로운 기능 구현 시 일관된 코드베이스에 맞춰야 하기 때문

#### 탐구
- 잠정성, 점진적 평가 도움

### 예상 활동에 대한 코드베이스 최적화
- 여러 다른 활동이 시스템에 서로 다른 제약을 가하는 것을 살펴봤다.
- 따라서 코드베이스에 대해 다른 사람이 어떤 작업을 수행할지 이해하고 있어야 한다.
- 상대적으로 오래되고 안정적인 라이브러리는 증가 활동보다는 검색 활동이 더 많이 일어날 가능성이 높은 반면, 새로운 앱은 증가 및 전사 활동이 일어날 가능성이 높다.
- 즉 코드베이스가 유지되는 동안에는 코드베이스에 대해 일어날 가능성이 가장 높은 활동에 맞는 설계 기동이 필요할 수 있다.
